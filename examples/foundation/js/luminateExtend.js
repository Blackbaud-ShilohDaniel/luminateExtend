/* luminateExtend.js | Version: 1.7.0 (16-APR-2015) */
!function(e){var t=function(t){return t&&e.inArray(t,["es_US","en_CA","fr_CA","en_GB","en_AU"])<0&&(t="en_US"),t},a=function(e){return e&&(e=t(e),luminateExtend.sessionVars.set("locale",e)),e},n=function(e,t){return(e?luminateExtend.global.path.secure+"S":luminateExtend.global.path.nonsecure)+"PageServer"+(luminateExtend.global.sessionCookie&&""!==luminateExtend.global.sessionCookie?";"+luminateExtend.global.sessionCookie:"")+"?pagename=luminateExtend_server&pgwrap=n"+(t?"&"+t:"")},i=function(t,a){if(t.responseFilter&&t.responseFilter.array&&t.responseFilter.filter&&luminateExtend.utils.stringToObj(t.responseFilter.array,a)){var n,i,r=t.responseFilter.filter.split("==")[0].split("!=")[0].replace(/^\s+|\s+$/g,"");if(-1!==t.responseFilter.filter.indexOf("!=")?(n="nequal",i=t.responseFilter.filter.split("!=")[1]):-1!==t.responseFilter.filter.indexOf("==")&&(n="equal",i=t.responseFilter.filter.split("==")[1]),n&&i){i=i.replace(/^\s+|\s+$/g,"");var l=[],o=!1;if(e.each(luminateExtend.utils.ensureArray(luminateExtend.utils.stringToObj(t.responseFilter.array,a)),function(){"nequal"===n&&this[r]===i||"equal"===n&&this[r]!==i?o=!0:l.push(this)}),o){var s=t.responseFilter.array.split(".");e.each(a,function(t,n){t===s[0]&&e.each(n,function(n,i){n===s[1]&&(2===s.length?a[t][n]=l:e.each(i,function(i,r){i===s[2]&&(3===s.length?a[t][n][i]=l:e.each(r,function(e){e===s[3]&&4===s.length&&(a[t][n][i][e]=l)}))}))})})}}}var u=e.noop;t.callback&&("function"==typeof t.callback?u=t.callback:t.callback.error&&a.errorResponse?u=t.callback.error:t.callback.success&&!a.errorResponse&&(u=t.callback.success));var d=-1!==t.data.indexOf("&method=login")&&-1===t.data.indexOf("&method=loginTest"),p=-1!==t.data.indexOf("&method=logout");if(d||p){var c=function(){u(a)},m={callback:c,useCache:!1,useHTTPS:t.useHTTPS};d&&a.loginResponse&&a.loginResponse.nonce&&(m.nonce="NONCE_TOKEN="+a.loginResponse.nonce),luminateExtend.api.getAuth(m)}else u(a)};window.luminateExtend=function(e){luminateExtend.init(e||{})},luminateExtend.library={version:"1.7.0"},luminateExtend.global={update:function(t,n){t&&(t.length?n&&("locale"===t&&(n=a(n)),luminateExtend.global[t]=n):(t.locale&&(t.locale=a(t.locale)),luminateExtend.global=e.extend(luminateExtend.global,t)))}},luminateExtend.init=function(a){var n=e.extend({apiCommon:{},auth:{type:"auth"},path:{}},a||{});if(n.locale&&(n.locale=t(n.locale)),n.supportsCORS=!1,window.XMLHttpRequest){var i=new XMLHttpRequest;"withCredentials"in i&&(n.supportsCORS=!0)}return luminateExtend.global=e.extend(luminateExtend.global,n),luminateExtend},luminateExtend.api=function(e){luminateExtend.api.request(e||{})},luminateExtend.api.bind=function(t){return t=t||"form.luminateApi",e(t).length>0&&e(t).each(function(){"form"===this.nodeName.toLowerCase()&&e(this).bind("submit",function(t){t.cancelBubble=!0,t.returnValue=!1,t.stopPropagation&&(t.stopPropagation(),t.preventDefault()),e(this).attr("id")||e(this).attr("id","luminateApi-"+(new Date).getTime());var a,n=e(this).attr("action"),i=n.split("?"),r=e(this).data("luminateapi"),l=-1!==i[0].indexOf("/site/")?i[0].split("/site/")[1]:i[0],o=e(this).attr("enctype"),s=i.length>1?i[1]:"",u="#"+e(this).attr("id"),d=!1,p=e(this).attr("method"),c=!1;r&&(r.callback&&(a=luminateExtend.utils.stringToObj(r.callback)),r.requiresAuth&&"true"===r.requiresAuth&&(d=!0),(0===n.indexOf("https:")||"https:"===window.location.protocol&&-1===n.indexOf("http"))&&(c=!0)),luminateExtend.api.request({api:l,callback:a,contentType:o,data:s,form:u,requestType:p,requiresAuth:d,useHTTPS:c})})}),luminateExtend},luminateExtend.api.getAuth=function(t){var a=e.extend({useCache:!0,useHTTPS:!1},t||{});if(luminateExtend.api.getAuthLoad)if(luminateExtend.api.getAuthLoad=!1,a.useCache&&luminateExtend.global.auth.type&&luminateExtend.global.auth.token)luminateExtend.api.getAuthLoad=!0,a.callback&&a.callback();else{var i=function(e){luminateExtend.global.update(e),luminateExtend.api.getAuthLoad=!0,a.callback&&a.callback()};e.ajax(luminateExtend.global.supportsCORS?{url:(a.useHTTPS?luminateExtend.global.path.secure:luminateExtend.global.path.nonsecure)+"CRConsAPI",data:"luminateExtend="+luminateExtend.library.version+(a.nonce&&""!==a.nonce?"&"+a.nonce:"")+"&api_key="+luminateExtend.global.apiKey+"&method=getLoginUrl&response_format=json&v=1.0",xhrFields:{withCredentials:!0},dataType:"json",success:function(e){var t=e.getLoginUrlResponse,a=t.url;i({auth:{type:"auth",token:t.token},sessionCookie:a.split("CRConsAPI;").length>1?a.split("CRConsAPI;")[1]:""})}}:{url:n(a.useHTTPS,"action=getAuth&callback=?"),dataType:"jsonp",success:i})}else{var r=function(){luminateExtend.api.getAuth(a)};setTimeout(r,1e3)}},luminateExtend.api.getAuthLoad=!0;var r=function(t){var a=e.extend({contentType:"application/x-www-form-urlencoded",data:"",requestType:"GET",requiresAuth:!1,useHashTransport:!1,useHTTPS:null},t||{}),r=["addressbook","advocacy","connect","cons","content","datasync","donation","email","group","orgevent","recurring","survey","teamraiser"];if(e.inArray(a.api.toLowerCase(),r)>=0&&(a.api="CR"+a.api.charAt(0).toUpperCase()+a.api.slice(1).toLowerCase()+"API",a.api=a.api.replace("Addressbook","AddressBook").replace("Datasync","DataSync").replace("Orgevent","OrgEvent")),luminateExtend.global.path.nonsecure&&luminateExtend.global.path.secure&&luminateExtend.global.apiKey&&a.api){"multipart/form-data"!==a.contentType&&(a.contentType="application/x-www-form-urlencoded"),a.data="luminateExtend="+luminateExtend.library.version+(""===a.data?"":"&"+a.data),a.form&&e(a.form).length>0&&(a.data+="&"+e(a.form).eq(0).serialize()),-1===a.data.indexOf("&api_key=")&&(a.data+="&api_key="+luminateExtend.global.apiKey),luminateExtend.global.apiCommon.centerId&&-1===a.data.indexOf("&center_id=")&&(a.data+="&center_id="+luminateExtend.global.apiCommon.centerId),luminateExtend.global.apiCommon.categoryId&&-1===a.data.indexOf("&list_category_id=")&&(a.data+="&list_category_id="+luminateExtend.global.apiCommon.categoryId),-1!==a.data.indexOf("&response_format=xml")?a.data=a.data.replace(/&response_format=xml/g,"&response_format=json"):-1===a.data.indexOf("&response_format=")&&(a.data+="&response_format=json"),luminateExtend.global.apiCommon.source&&-1===a.data.indexOf("&source=")&&(a.data+="&source="+luminateExtend.global.apiCommon.source),luminateExtend.global.apiCommon.subSource&&-1===a.data.indexOf("&sub_source=")&&(a.data+="&sub_source="+luminateExtend.global.apiCommon.subSource),-1===a.data.indexOf("&suppress_response_codes=")&&(a.data+="&suppress_response_codes=true"),luminateExtend.global.locale&&-1===a.data.indexOf("&s_locale=")&&(a.data+="&s_locale="+luminateExtend.global.locale),-1===a.data.indexOf("&v=")&&(a.data+="&v=1.0"),a.requestType="post"===a.requestType.toLowerCase()?"POST":"GET";var l="http://",o=luminateExtend.global.path.nonsecure.split("http://")[1];a.useHTTPS="CRDonationAPI"===a.api||"CRTeamraiserAPI"===a.api||"CRConnectAPI"!==a.api&&("https:"===window.location.protocol&&null==a.useHTTPS||1==a.useHTTPS)?!0:!1,a.useHTTPS&&(l="https://",o=luminateExtend.global.path.secure.split("https://")[1]),l+=o+a.api;var s=!1,u=!1,d=!1;window.location.protocol!==l.split("//")[0]||document.domain!==o.split("/")[0]||a.useHashTransport?luminateExtend.global.supportsCORS&&!a.useHashTransport?u=!0:"postMessage"in window&&!a.useHashTransport&&(d=!0):(s=!0,u=!0);var p;p=u?function(){a.requiresAuth&&-1===a.data.indexOf("&"+luminateExtend.global.auth.type+"=")&&(a.data+="&"+luminateExtend.global.auth.type+"="+luminateExtend.global.auth.token),luminateExtend.global.sessionCookie&&""!==luminateExtend.global.sessionCookie&&(l+=";"+luminateExtend.global.sessionCookie),a.data+="&ts="+(new Date).getTime(),e.ajax({url:l,data:a.data,xhrFields:{withCredentials:!0},contentType:a.contentType,dataType:"json",type:a.requestType,success:function(e){i(a,e)}})}:d?function(){var t=(new Date).getTime(),r="luminateApiPostMessage"+t,o=n(a.useHTTPS,"action=postMessage");a.requiresAuth&&-1===a.data.indexOf("&"+luminateExtend.global.auth.type+"=")&&(a.data+="&"+luminateExtend.global.auth.type+"="+luminateExtend.global.auth.token),a.data+="&ts="+t,luminateExtend.api.request.postMessageEventHandler||(luminateExtend.api.request.postMessageEventHandler={},luminateExtend.api.request.postMessageEventHandler.handler=function(t){if(-1!==luminateExtend.global.path.nonsecure.indexOf(t.origin)||-1!==luminateExtend.global.path.secure.indexOf(t.origin)){var a=e.parseJSON(t.data),n=a.postMessageFrameId,i=e.parseJSON(decodeURIComponent(a.response));luminateExtend.api.request.postMessageEventHandler[n]&&luminateExtend.api.request.postMessageEventHandler[n](n,i)}},"undefined"!=typeof window.addEventListener?window.addEventListener("message",luminateExtend.api.request.postMessageEventHandler.handler,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onmessage",luminateExtend.api.request.postMessageEventHandler.handler)),luminateExtend.api.request.postMessageEventHandler[r]=function(t,n){i(a,n),e("#"+t).remove(),delete luminateExtend.api.request.postMessageEventHandler[t]},e("body").append('<iframe style="position: absolute; top: 0; left: -999em;" name="'+r+'" id="'+r+'"></iframe>'),e("#"+r).bind("load",function(){var t='{"postMessageFrameId": "'+e(this).attr("id")+'", "requestUrl": "'+l+'", "requestContentType": "'+a.contentType+'", "requestData": "'+a.data+'", "requestType": "'+a.requestType+'"}',n=l.split("/site/")[0].split("/admin/")[0];document.getElementById(e(this).attr("id")).contentWindow.postMessage(t,n)}),e("#"+r).attr("src",o)}:function(){var t=(new Date).getTime(),r="luminateApiHashTransport"+t,o=n(a.useHTTPS,"action=hashTransport"),s=window.location.protocol+"//"+document.domain+"/luminateExtend_client.html";a.requiresAuth&&-1===a.data.indexOf("&"+luminateExtend.global.auth.type+"=")&&(a.data+="&"+luminateExtend.global.auth.type+"="+luminateExtend.global.auth.token),a.data+="&ts="+t,o+="#&hashTransportClientUrl="+encodeURIComponent(s)+"&hashTransportFrameId="+r+"&requestUrl="+encodeURIComponent(l)+"&requestContentType="+encodeURIComponent(a.contentType)+"&requestData="+encodeURIComponent(a.data)+"&requestType="+a.requestType,luminateExtend.api.request.hashTransportEventHandler||(luminateExtend.api.request.hashTransportEventHandler={},luminateExtend.api.request.hashTransportEventHandler.handler=function(e,t){luminateExtend.api.request.hashTransportEventHandler[e]&&luminateExtend.api.request.hashTransportEventHandler[e](e,t)}),luminateExtend.api.request.hashTransportEventHandler[r]=function(t,n){i(a,n),e("#"+t).remove(),delete luminateExtend.api.request.hashTransportEventHandler[t]},e("body").append('<iframe style="position: absolute; top: 0; left: -999em;" name="'+r+'" id="'+r+'" src="'+o+'"></iframe>')},a.requiresAuth||!u&&!s&&!luminateExtend.global.sessionCookie?luminateExtend.api.getAuth({callback:p,useHTTPS:a.useHTTPS}):p()}};luminateExtend.api.request=function(t){if(e.isArray(t)){t.reverse();var a=[];e.each(t,function(n){var i=e.extend({async:!0},this);if(i.async||n===t.length-1)a.push(i);else{var l=t[n+1];if(l.callback&&"function"!=typeof l.callback){var o=l.callback.success||e.noop;l.callback.success=function(e){o(e),r(i)}}else{var l=t[n+1],s=l.callback||e.noop;l.callback={success:function(e){s(e),r(i)},error:function(e){s(e)}}}}}),a.reverse(),e.each(a,function(){r(this)})}else r(t)},luminateExtend.sessionVars={set:function(e,t,a){var n={};a&&(n.callback=a),e&&(n.data="s_"+e+"="+(t||""),luminateExtend.utils.ping(n))}},luminateExtend.tags=function(e,t){luminateExtend.tags.parse(e,t)},luminateExtend.tags.parse=function(t,a){luminateExtend.widgets?luminateExtend.widgets(t,a):(t=t&&"all"!==t?luminateExtend.utils.ensureArray(t):["cons"],a=a||"body",e.each(t,function(t,n){if("cons"===n){var i=e(a).find(document.getElementsByTagName("luminate:cons"));if(i.length>0){var r=function(t){i.each(function(){t.getConsResponse?e(this).replaceWith(luminateExtend.utils.stringToObj(e(this).attr("field"),t.getConsResponse)):e(this).remove()})};luminateExtend.api.request({api:"cons",callback:r,data:"method=getUser",requestType:"POST",requiresAuth:!0})}}}))},luminateExtend.utils={ensureArray:function(t){return e.isArray(t)?t:t?[t]:[]},stringToObj:function(e,t){var a=t||window;if(e)for(var n=e.split("."),i=0;i<n.length;i++){if(i<n.length-1&&!a[n[i]])return{};a=a[n[i]]}return a},ping:function(t){var a=e.extend({data:null},t||{}),n="luminatePing"+(new Date).getTime();e("body").append('<img style="position: absolute; left: -999em; top: 0;" id="'+n+'" />'),e("#"+n).bind("load",function(){e(this).remove(),a.callback&&a.callback()}),e("#"+n).attr("src",("https:"===window.location.protocol?luminateExtend.global.path.secure:luminateExtend.global.path.nonsecure)+"EstablishSession?"+(null==a.data?"":a.data+"&")+"NEXTURL="+encodeURIComponent(("https:"===window.location.protocol?luminateExtend.global.path.secure:luminateExtend.global.path.nonsecure)+"PixelServer"))},simpleDateFormat:function(a,n,i){if(i=i||luminateExtend.global.locale,i=t(i),n=n||(e.inArray(i,["en_CA","fr_CA","en_GB","en_AU"])>=0?"d/M/yy":"M/d/yy"),a=a||new Date,!(a instanceof Date)){var r=a.split("T")[0].split("-"),l=a.split("T").length>1?a.split("T")[1].split(".")[0].split("Z")[0].split("-")[0].split(":"):["00","00","00"];a=new Date(r[0],r[1]-1,r[2],l[0],l[1],l[2])}var o=function(e){return e=""+e,0===e.indexOf("0")&&"0"!==e?e.substring(1):e},s=function(e){return e=Number(e),isNaN(e)?"00":(10>e?"0":"")+e},u={month:s(a.getMonth()+1),date:s(a.getDate()),year:s(a.getFullYear()),day:a.getDay(),hour24:a.getHours(),hour12:a.getHours(),minutes:s(a.getMinutes()),ampm:"AM"};u.hour24>11&&(u.ampm="PM"),u.hour24=s(u.hour24),0===u.hour12&&(u.hour12=12),u.hour12>12&&(u.hour12=u.hour12-12),u.hour12=s(u.hour12);var d,p=function(e){var t=e.replace(/yy+(?=y)/g,"yy").replace(/MMM+(?=M)/g,"MMM").replace(/d+(?=d)/g,"d").replace(/EEE+(?=E)/g,"EEE").replace(/a+(?=a)/g,"").replace(/k+(?=k)/g,"k").replace(/h+(?=h)/g,"h").replace(/m+(?=m)/g,"m"),a=t.replace(/yyy/g,u.year).replace(/yy/g,u.year.substring(2)).replace(/y/g,u.year).replace(/dd/g,u.date).replace(/d/g,o(u.date)),n=function(e,t,a){for(var n=1;n<e.length;n++)if(!isNaN(e[n].substring(0,1))){var i=e[n].substring(0,2);e[n]=e[n].substring(2),isNaN(i.substring(1))&&(e[n]=i.substring(1)+e[n],i=i.substring(0,1)),i=Number(i),i>23&&(i=23);var r="+"===a?i:0-i;"kk"===t||"k"===t?(r=Number(u.hour24)+r,r>24?r-=24:0>r&&(r+=24)):(r=Number(u.hour12)+r,r>24?r-=24:0>r&&(r+=24),r>12&&(r-=12)),r=""+r,("kk"===t||"hh"===t)&&(r=s(r)),("h"===t&&0===r||"hh"===t&&"00"===r)&&(r="12"),e[n]=r+e[n]}return e.join("")};-1!==a.indexOf("k+")&&(a=n(a.split("kk+"),"kk","+"),a=n(a.split("k+"),"k","+")),-1!==a.indexOf("k-")&&(a=n(a.split("kk-"),"kk","-"),a=n(a.split("k-"),"k","-")),a=a.replace(/kk/g,u.hour24).replace(/k/g,o(u.hour24)),-1!==a.indexOf("h+")&&(a=n(a.split("hh+"),"hh","+"),a=n(a.split("h+"),"h","+")),-1!==a.indexOf("h-")&&(a=n(a.split("hh-"),"hh","-"),a=n(a.split("h-"),"h","-")),a=a.replace(/hh/g,u.hour12<12&&u.hour12.indexOf&&0!==u.hour12.indexOf("0")?"0"+u.hour12:u.hour12).replace(/h/g,o(u.hour12)),a=a.replace(/mm/g,u.minutes).replace(/m/g,o(u.minutes)),a=a.replace(/a/g,"A");var r=["January","February","march","april","may","June","July","august","September","October","November","December"];"es_US"===i&&(r=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]),"fr_CA"===i&&(r=["janvier","f&#233;vrier","mars","avril","mai","juin","juillet","ao&#251;t","septembre","octobre","novembre","d&#233;cembre"]),a=a.replace(/MMMM/g,r[Number(u.month)-1]).replace(/MMM/g,r[Number(u.month)-1].substring(0,3)).replace(/MM/g,u.month).replace(/M/g,o(u.month)).replace(/march/g,"March").replace(/may/g,"May").replace(/Mayo/g,"mayo");var l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return"es_US"===i&&(l=["domingo","lunes","martes","mi&eacute;rcoles","jueves","viernes","s&aacute;bado"]),"fr_CA"===i&&(l=["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]),a=a.replace(/EEEE/g,l[u.day]).replace(/EEE/g,l[u.day].substring(0,3)).replace(/EE/g,l[u.day].substring(0,3)).replace(/E/g,l[u.day].substring(0,3)),a=a.replace(/A/g,u.ampm).replace(/april/g,"April").replace(/august/g,"August")};if(-1!==n.indexOf("'")){var c=n.replace(/\'+(?=\')/g,"''").split("''");if(1===c.length){c=n.split("'");for(var m=0;m<c.length;m++)m%2===0&&(c[m]=p(c[m]));return c.join("")}for(var m=0;m<c.length;m++){for(var h=c[m].split("'"),g=0;g<h.length;g++)g%2===0&&(h[g]=p(h[g]));c[m]=h.join("")}return c.join("'")}return d=p(n)}}}("undefined"==typeof jQuery&&"function"==typeof Zepto?Zepto:jQuery)